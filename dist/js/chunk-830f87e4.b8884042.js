(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-830f87e4"],{"06b7":function(t,e,o){},"0c71":function(t,e,o){"use strict";o.r(e);var s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"search"},[o("Row",[o("Col",[o("Card",[o("Row",{nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(e)}}},[o("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:t.searchForm,inline:"","label-width":70}},[o("Form-item",{attrs:{label:"商品id",prop:"goodsId"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品id",clearable:""},model:{value:t.searchForm.goodsId,callback:function(e){t.$set(t.searchForm,"goodsId",e)},expression:"searchForm.goodsId"}})],1),t.drop?o("span",[o("Form-item",{attrs:{label:"商品名",prop:"title"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品名",clearable:""},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),o("Form-item",{attrs:{label:"商品类型",prop:"type"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品类型",clearable:""},model:{value:t.searchForm.type,callback:function(e){t.$set(t.searchForm,"type",e)},expression:"searchForm.type"}})],1),o("Form-item",{attrs:{label:"商品图片",prop:"img"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品图片",clearable:""},model:{value:t.searchForm.img,callback:function(e){t.$set(t.searchForm,"img",e)},expression:"searchForm.img"}})],1),o("Form-item",{attrs:{label:"商品单价",prop:"price"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品单价",clearable:""},model:{value:t.searchForm.price,callback:function(e){t.$set(t.searchForm,"price",e)},expression:"searchForm.price"}})],1),o("Form-item",{attrs:{label:"商品简介",prop:"content"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品简介",clearable:""},model:{value:t.searchForm.content,callback:function(e){t.$set(t.searchForm,"content",e)},expression:"searchForm.content"}})],1),o("Form-item",{attrs:{label:"商品状态",prop:"status"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品状态",clearable:""},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}})],1),o("Form-item",{attrs:{label:"商品库存",prop:"count"}},[o("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入商品库存",clearable:""},model:{value:t.searchForm.count,callback:function(e){t.$set(t.searchForm,"count",e)},expression:"searchForm.count"}})],1)],1):t._e(),o("Form-item",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[o("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.handleSearch}},[t._v("搜索")]),o("Button",{on:{click:t.handleReset}},[t._v("重置")]),o("a",{staticClass:"drop-down",on:{click:t.dropDown}},[t._v(" "+t._s(t.dropDownContent)+" "),o("Icon",{attrs:{type:t.dropDownIcon}})],1)],1)],1)],1),o("Row",{staticClass:"operation"},[o("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:t.add}},[t._v("添加商品")]),o("Button",{attrs:{icon:"md-trash"},on:{click:t.delAll}},[t._v("批量删除")]),o("Dropdown",{on:{"on-click":t.handleDropdown}},[o("Button",[t._v(" 更多操作 "),o("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),o("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[o("DropdownItem",{attrs:{name:"refresh"}},[t._v("刷新")]),o("DropdownItem",{attrs:{name:"reset"}},[t._v("重置商品密码")]),o("DropdownItem",{attrs:{name:"exportData"}},[t._v("导出所选数据")]),o("DropdownItem",{attrs:{name:"exportAll"}},[t._v("导出全部数据")]),o("DropdownItem",{attrs:{name:"importData"}},[t._v("导入数据")])],1)],1)],1),o("Row",[o("Alert",{attrs:{"show-icon":""}},[t._v(" 已选择 "),o("span",{staticClass:"select-count"},[t._v(t._s(t.selectCount))]),t._v(" 项 "),o("a",{staticClass:"select-clear",on:{click:t.clearSelectAll}},[t._v("清空")])])],1),o("Row",[o("Table",{ref:"table",attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data,sortable:"custom"},on:{"on-sort-change":t.changeSort,"on-selection-change":t.showSelect}})],1),o("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[o("Page",{attrs:{current:t.searchForm.pageNumber,total:t.total,"page-size":t.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1)],1)],1),o("Modal",{attrs:{title:t.modalTitle,"mask-closable":!1,width:500},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[o("Form",{ref:"form",attrs:{model:t.form,"label-width":100,rules:t.formValidate}},[o("Form-item",{attrs:{label:"商品id",prop:"goodsId"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品id",clearable:""},model:{value:t.form.goodsId,callback:function(e){t.$set(t.form,"goodsId",e)},expression:"form.goodsId"}})],1),o("Form-item",{attrs:{label:"商品名",prop:"title"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品名",clearable:""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),o("Form-item",{attrs:{label:"商品类型",prop:"type"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品类型",clearable:""},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}})],1),o("Form-item",{attrs:{label:"商品图片",prop:"img"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品图片",clearable:""},model:{value:t.form.img,callback:function(e){t.$set(t.form,"img",e)},expression:"form.img"}})],1),o("Form-item",{attrs:{label:"商品单价",prop:"price"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品单价",clearable:""},model:{value:t.form.price,callback:function(e){t.$set(t.form,"price",e)},expression:"form.price"}})],1),o("Form-item",{attrs:{label:"商品简介",prop:"content"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品简介",clearable:""},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),o("Form-item",{attrs:{label:"商品状态",prop:"status"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品状态",clearable:""},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}})],1),o("Form-item",{attrs:{label:"商品库存",prop:"count"}},[o("Input",{staticStyle:{width:"100%"},attrs:{type:"text",placeholder:"请输入商品库存",clearable:""},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1)],1),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"text"},on:{click:function(e){t.modalVisible=!1}}},[t._v("取消")]),o("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1),o("Modal",{attrs:{title:t.exportTitle,loading:t.loadingExport},on:{"on-ok":t.exportCustomData},model:{value:t.exportModalVisible,callback:function(e){t.exportModalVisible=e},expression:"exportModalVisible"}},[o("Form",{ref:"exportForm",attrs:{"label-width":85}},[o("FormItem",{attrs:{label:"导出文件名"}},[o("Input",{model:{value:t.filename,callback:function(e){t.filename=e},expression:"filename"}})],1),o("FormItem",{attrs:{label:"自定义导出列"}},[o("CheckboxGroup",{model:{value:t.chooseColumns,callback:function(e){t.chooseColumns=e},expression:"chooseColumns"}},t._l(t.exportColumns,(function(t,e){return o("Checkbox",{key:e,attrs:{label:t.title,value:t.checked,disabled:t.disabled}})})),1)],1)],1)],1),o("Drawer",{attrs:{title:"导入数据",closable:"",width:"1000"},model:{value:t.importModalVisible,callback:function(e){t.importModalVisible=e},expression:"importModalVisible"}},[o("Upload",{attrs:{action:"","before-upload":t.beforeUploadImport,accept:".xls, .xlsx"}},[o("Button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传Excel文件")]),""!=t.uploadfile.name?o("span",[t._v("当前选择文件："+t._s(t.uploadfile.name))]):t._e()],1),o("Alert",{attrs:{type:"warning","show-icon":""}},[t._v("导入前请下载查看导入模版数据文件，确保数据格式正确，不得修改列英文名称。必需数据字段：商品名(唯一)、密码(明文)")]),o("Table",{ref:"importTable",attrs:{columns:t.importColumns,border:"",height:t.height,data:t.importTableData}}),o("div",{staticClass:"drawer-footer"},[o("Button",{staticStyle:{position:"absolute",left:"15px"},attrs:{type:"info"},on:{click:t.downloadTemple}},[t._v("下载导入模板")]),o("Button",{on:{click:function(e){t.importModalVisible=!1}}},[t._v("关闭")]),o("Button",{staticStyle:{"margin-left":"5px"},attrs:{loading:t.importLoading,disabled:t.importTableData.length<=0,type:"primary"},on:{click:t.importData}},[t._v(" 确认导入 "),t.importTableData.length>0?o("span",[t._v(t._s(t.importTableData.length)+" 条数据")]):t._e()])],1)],1),o("check-password",{ref:"checkPass",on:{"on-success":t.resetPass}})],1)},a=[],i=(o("4160"),o("caad"),o("d81d"),o("4e82"),o("b0c0"),o("a9e3"),o("ac1f"),o("2532"),o("1276"),o("159b"),o("7f80")),r=function(t){return Object(i["b"])("/goods/getByCondition",t)},l=function(t){return Object(i["b"])("/goods/getAll",t)},n=function(t){return Object(i["c"])("/goods/add",t)},c=function(t,e){return Object(i["a"])("/goods/delByIds/".concat(t),e)},d=function(t,e){return Object(i["c"])("/goods/dealWith",t,e)},m=(o("10fd"),o("f6c5")),p=o("51a6"),h=[{title:"商品id",key:"goodsId"},{title:"商品名",key:"title"},{title:"商品类型",key:"type"},{title:"商品图片",key:"img"},{title:"商品单价",key:"price"},{title:"商品简介",key:"content"},{title:"商品状态",key:"status"},{title:"商品库存",key:"count"}],u=o("0a21"),f={name:"GoodsManage",components:{checkPassword:m["a"]},data:function(){var t=this;return{height:510,loading:!0,importLoading:!1,loadingExport:!0,exportModalVisible:!1,importModalVisible:!1,drop:!1,dropDownContent:"展开",dropDownIcon:"ios-arrow-down",selectCount:0,selectList:[],searchForm:{pageNumber:1,pageSize:10,sort:"createTime",order:"desc",type:"0"},modalType:0,modalVisible:!1,modalTitle:"",form:{goodsId:"",title:"",type:"",img:"",price:"",content:"",status:"",count:""},formValidate:{},submitLoading:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"商品id",key:"goodsId",minWidth:120,sortable:!1},{title:"商品名",key:"title",minWidth:120,sortable:!1},{title:"商品类型",key:"type",minWidth:120,sortable:!1},{title:"商品图片",key:"img",minWidth:120,sortable:!1},{title:"商品单价",key:"price",minWidth:120,sortable:!1},{title:"商品简介",key:"content",minWidth:120,sortable:!1},{title:"商品状态",key:"status",minWidth:120,sortable:!1},{title:"商品库存",key:"count",minWidth:120,sortable:!1},{title:"操作",key:"action",width:200,align:"center",fixed:"right",render:function(e,o){var s="";return s="未下架"==o.row.status?e("Button",{props:{size:"small"},style:{marginRight:"5px"},on:{click:function(){t.dealWith(o.row)}}},"未下架"):e("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"}},"已下架"),e("div",[e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.edit(o.row)}}},"编辑"),s,e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.remove(o.row)}}},"删除")])}}],exportColumns:h,chooseColumns:[],filename:"商品",exportTitle:"确认导出",exportType:"",importTableData:[],importColumns:[],uploadfile:{name:""},tempColumns:p["goodsColumns"],tempData:p["goodsData"],data:[],exportData:[],total:0,dictSex:this.$store.state.dict.sex}},methods:{init:function(){var t=this;this.getGoodsList();var e=[];this.exportColumns.forEach((function(o){t.getStore("roles").includes("ROLE_ADMIN")||"mobile"!=o.key?o.disabled=!1:(o.title="[无权导出] "+o.title,o.disabled=!0),e.push(o.title)})),this.chooseColumns=e},handleSelectDepTree:function(t){this.form.departmentId=t[0]},handleSelectDep:function(t){this.searchForm.departmentId=t},changePage:function(t){this.searchForm.pageNumber=t,this.getGoodsList(),this.clearSelectAll()},changePageSize:function(t){this.searchForm.pageSize=t,this.getGoodsList()},selectDateRange:function(t){t&&(this.searchForm.startDate=t[0],this.searchForm.endDate=t[1])},getGoodsList:function(){var t=this;this.loading=!0,this.searchForm.type||(this.searchForm.type=""),this.searchForm.status||(this.searchForm.status=""),r(this.searchForm).then((function(e){console.log(e),t.loading=!1,e.success&&(t.data=e.result.content,t.total=e.result.totalElements)}))},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getGoodsList()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.$refs.dep.clearSelect(),this.searchForm.departmentId="",this.getGoodsList()},changeSort:function(t){this.searchForm.sort=t.key,this.searchForm.order=t.order,"normal"==t.order&&(this.searchForm.order=""),this.getGoodsList()},getRoleList:function(){var t=this;getAllRoleList().then((function(e){e.success&&(t.roleList=e.result)}))},handleDropdown:function(t){var e=this;if("refresh"==t)this.getGoodsList();else if("reset"==t){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要重置密码的商品");this.$refs.checkPass.show()}else if("exportData"==t){if(this.selectCount<=0)return void this.$Message.warning("您还未选择要导出的数据");this.exportType="part",this.exportModalVisible=!0,this.exportTitle="确认导出 "+this.selectCount+" 条数据 "}else"exportAll"==t?(this.exportType="all",this.exportModalVisible=!0,this.exportTitle="确认导出全部 "+this.total+" 条数据 ",l().then((function(t){t.success&&(e.exportData=t.result)}))):"importData"==t&&(this.importModalVisible=!0)},resetPass:function(){var t=this;this.$Modal.confirm({title:"确认重置",content:"您确认要重置所选的 "+this.selectCount+" 条商品数据密码为【123456】?",loading:!0,onOk:function(){var e="";t.selectList.forEach((function(t){e+=t.id+","})),e=e.substring(0,e.length-1),resetGoodsPass({ids:e}).then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("操作成功"),t.clearSelectAll(),t.getGoodsList())}))}})},exportCustomData:function(){var t=this;""==this.filename&&(this.filename="商品 ");var e=[];this.exportColumns.forEach((function(o){t.chooseColumns.forEach((function(t){o.title!=t||o.disabled||e.push(o)}))})),this.exportColumns=e,this.exportModalVisible=!1;var o=[],s=[];this.exportColumns.forEach((function(t){o.push(t.title),s.push(t.key)}));var a={title:o,key:s,data:this.exportData,autoWidth:!0,filename:this.filename};u["a"].export_array_to_excel(a)},beforeUploadImport:function(t){this.uploadfile=t;var e=t.name.split(".").pop().toLocaleLowerCase();return"xlsx"==e||"xls"==e?(this.readFile(t),this.file=t):this.$Notice.warning({title:"文件类型错误",desc:"所选文件‘ "+t.name+" ’不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。"}),!1},readFile:function(t){var e=this,o=new FileReader;o.readAsArrayBuffer(t),o.onerror=function(t){e.$Message.error("文件读取出错")},o.onload=function(t){e.$Message.success("读取数据成功");var o=t.target.result,s=u["a"].read(o,"array"),a=s.header,i=s.results,r=a.map((function(t){return{title:t,key:t}}));e.importTableData=i,e.importColumns=r}},downloadTemple:function(){var t=[],e=[];p["goodsColumns"].forEach((function(o){t.push(o.title),e.push(o.key)}));var o={title:t,key:e,data:p["goodsData"],autoWidth:!0,filename:"导入商品模板"};u["a"].export_array_to_excel(o)},importData:function(){var t=this;this.importLoading=!0,importGoodsData(this.importTableData).then((function(e){t.importLoading=!1,e.success&&(t.importModalVisible=!1,t.getGoodsList(),t.$Modal.info({title:"导入结果",content:e.message}))}))},cancelGoods:function(){this.modalVisible=!1},handleSubmit:function(){var t=this;this.$refs.form.validate((function(e){console.log(e),e&&(0==t.modalType?(delete t.form.id,delete t.form.status,delete t.form.goodsId,delete t.form.mobile,t.submitLoading=!0,n(t.form).then((function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.getGoodsList(),t.modalVisible=!1)}))):(t.submitLoading=!0,editGoods(t.form).then((function(e){t.submitLoading=!1,e.success&&(t.$Message.success("操作成功"),t.getGoodsList(),t.modalVisible=!1)}))))}))},handleUpload:function(t){this.form.avatar=t},add:function(){this.modalType=0,this.modalTitle="添加商品 ",this.$refs.form.resetFields(),this.modalVisible=!0},edit:function(t){for(var e in this.modalType=1,this.modalTitle="编辑商品 ",this.$refs.form.resetFields(),t)null==t[e]&&(t[e]="");var o=JSON.stringify(t),s=JSON.parse(o);this.form=s;var a=[];this.form.roles.forEach((function(t){a.push(t.id)})),this.form.roles=a,this.modalVisible=!0},enable:function(t){var e=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用商品 "+t.goodsname+" ?",loading:!0,onOk:function(){enableGoods(t.id).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.success("操作成功"),e.getGoodsList())}))}})},disable:function(t){var e=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用商品 "+t.goodsname+" ?",loading:!0,onOk:function(){disableGoods(t.id).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.success("操作成功"),e.getGoodsList())}))}})},remove:function(t){var e=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除商品 : "+t.content+" ?",loading:!0,onOk:function(){c(t.id).then((function(t){e.$Modal.remove(),t.success&&(e.$Message.success("删除成功"),e.getGoodsList())}))}})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="ios-arrow-down"):(this.dropDownContent="收起",this.dropDownIcon="ios-arrow-up"),this.drop=!this.drop},showSelect:function(t){this.exportData=t,this.selectList=t,this.selectCount=t.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},delAll:function(){var t=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",loading:!0,onOk:function(){var e="";t.selectList.forEach((function(t){e+=t.id+","})),e=e.substring(0,e.length-1),c(e).then((function(e){t.$Modal.remove(),e.success&&(t.$Message.success("删除成功"),t.clearSelectAll(),t.getGoodsList())}))}})},dealWith:function(t){var e=this;this.$Modal.confirm({title:"确认处理",content:"您确认要处理商品 : "+t.content+" ?",loading:!0,onOk:function(){d(t.id,{id:t.id}).then((function(o){console.log(t,t.id,o),e.$Modal.remove(),o.success&&(e.$Message.success("处理成功"),e.getGoodsList())}))}})}},mounted:function(){this.height=Number(document.documentElement.clientHeight-230),this.init()}},g=f,b=(o("9cdc"),o("2877")),y=Object(b["a"])(g,s,a,!1,null,null,null);e["default"]=y.exports},"9cdc":function(t,e,o){"use strict";var s=o("06b7"),a=o.n(s);a.a}}]);
//# sourceMappingURL=chunk-830f87e4.b8884042.js.map